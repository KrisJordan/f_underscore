// if(this['require'] !== undefined) {
// var _ = require('underscore');
// }
var f_={};window.f_=f_;f_.I=f_.i=_.identity;var _wire=function(a,b,c){_.each(b,function(b,d){var f=_.first(b),g=_.rest(b);a[d]=f_.partial(c,f);_.each(g,f_.setByProperty(a,function(){return a[d]}))})};f_.partial=function(a){var b=_.rest(arguments,1);return function(){return a.apply(this,b.concat([].slice.apply(arguments)))}};f_.partialRight=f_.partialR=function(a){var b=_.rest(arguments,1);return function(c){return a.apply(this,[].slice.apply(arguments).concat(b))}};
f_.thru=f_.thread=function(){var a=arguments;return function(){for(var b=[].slice.apply(arguments),c=0;c<a.length;c++)b=[a[c].apply(this,b)];return b[0]}};f_.zipObject=function(a,b){var c=_.zip(a,b),e={};_.each(c,function(a){e[a[0]]=a[1]});return e};_.mixin({partial:f_.partial,partialRight:f_.partialRight,partialR:f_.partialRight,thru:f_.thru,thread:f_.thread,zipObject:f_.zipObject});f_.functionize=function(a){return _.isFunction(a)?a:function(){return a}};f_.get=function(a){return function(b){return b[a]}};
f_.getByProperty=function(a){return function(b){return a[b]}};f_.set=function(a,b){var c=f_.functionize(b);return function(b){b[a]=c(b);return b}};f_.setByProperty=function(a,b){var c=f_.functionize(b);return function(b){a[b]=c(a);return a}};f_.project=function(a){return function(b){return _.zipObject(a,_.map(a,f_.getByProperty(b)))}};
var add=function(a,b){return a+b},subtract=function(a,b){return a-b},multiply=function(a,b){return a*b},divide=function(a,b){return a/b},modulo=function(a,b){return a%b},increment=function(a){return a+1},decrement=function(a){return a-1},square=function(a){return a*a},negate=function(a){return a*-1},append=function(a,b){return""+a+b};greaterThan=function(a,b){return a>b};atLeast=function(a,b){return a>=b};lessThan=function(a,b){return a<b};atMost=function(a,b){return a<=b};
greaterOf=function(a,b){return a>b?a:b};lesserOf=function(a,b){return a<b?a:b};equality=_.isEqual;inequality=function(){return!equality.apply(this,arguments)};and=function(a,b){return a&&b};neither=function(a,b){return!a&&!b};or=function(a,b){return a||b};xor=function(a,b){return a&&!b||!a&&b};not=function(a){return!a};ternary=function(a,b,c){return a?b:c};var unaryExprs={increment:[increment,"incr"],decrement:[decrement,"decr"],square:[square,"sqr"],not:[not],negate:[negate,"neg"]};
f_.unaryExpr=function(a,b){var c=f_.functionize(b);return function(b){return a(c(b))}};_wire(f_,unaryExprs,f_.unaryExpr);
var binaryExprs={add:[add,"sum"],subtract:[subtract,"sub"],multiply:[multiply,"mul","prod"],divide:[divide,"div"],modulo:[modulo,"mod"],append:[append,"concat"],greaterThan:[greaterThan,"gt"],atLeast:[atLeast,"gte"],lessThan:[lessThan,"lt"],atMost:[atMost,"lte"],greaterOf:[greaterOf],lesserOf:[lesserOf],equality:[equality,"eq"],inequality:[inequality,"neq"],and:[and],neither:[neither],or:[or],xor:[xor]};
f_.binaryExpr=function(a,b,c){if(c===void 0)c=b,b=f_.i;var e=f_.functionize(b),d=f_.functionize(c);return function(b){return a(e(b),d(b))}};_wire(f_,binaryExprs,f_.binaryExpr);f_.ternaryExpr=function(a,b,c,e){var d=f_.functionize(b),f=f_.functionize(c),g=f_.functionize(e);return function(b){return a(d(b),f(b),g(b))}};var ternaryExprs={ternary:[ternary,"ifThenElse"]};_wire(f_,ternaryExprs,f_.ternaryExpr);
f_.reduceExpr=function(a,b){var c;c=b===void 0?f_.i:f_.functionize(b);return function(b,d){return a(b,c(d))}};var reducers={sum:[add],product:[multiply],count:[increment],min:[lesserOf],max:[greaterOf]};_wire(f_,reducers,f_.reduceExpr);f_.avg=f_.average=function(a){var b=0;return f_.reduceExpr(function(a,e){var d=a*b+e,f=++b;return d/f},a)};
